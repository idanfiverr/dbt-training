{%- set category = ["Furniture", "Office"] -%}

select
orderid,
{% for category in category %}
sum(case when category = '{{category}}' then orderprofit end) as {{category}}orderprofit
{% if not loop.last %}, {% endif %}
{% endfor%}
from {{ ref('stg_orders') }}
group by 1